= RAD RACE 2015

image:https://travis-ci.org/incodehq/radrace2015.png?branch=master[Build Status,link=https://travis-ci.org/incodehq/radrace2015]

On Sept 25th and 26th we (Jeroen van der Wal & me, Dan Haywood) took part in the http://www.radrace.org/en/index.html[Original RAD Race] competition.  This is a competition staged each year, this year (as in previous years) hosted and sponsored by Cap Gemini, and held in their offices in Utrecht, Netherlands.

The competition consists of teams of exactly two team members; there were eight in total.  The competition is held under very strict conditions: 8 hours of development on the first day, and a further 4 hours of coding the next.  If you do the maths you'll work out that means a sum total of 24 hours (2 team members x 12 hours), or 3 person-days.

We asked and were granted permission to develop our application as open source; our entry is in this repo.  If you look through the commit history you'll see that all the work was done in those 12 hours (8 on 25 Sept 2015, a further 4 on 26 Sept).

All the other teams used proprietary tools such as http://www.nout.fr/[NoutBuilder], http://www.thinkwisesoftware.com/en/[ThinkWise], https://www.progress.com/[Progress], http://www.salesforce.com/[SalesForce], http://www.uniface.com/[Uniface] and https://www.mendix.com/[Mendix].  We were the only open source entry, using http://isis.apache.org[Apache Isis] (along with supporting modules in http://isisaddons.org[Isis Addons]); in fact we think we are the first open source entry in the 17 years history of the competition.

OK, we didn't win... that honour went to Nout (who also won the year before), with ThinkWise in the runners' up position.  Teams weren't particularly ranked after that, but we got the impression we were mid-table, which we think is pretty good in the face of the competition.  But you can judge for yourself; either download and build the code, or simply scroll down the page to look at the screenshots/our commentary of the app.

The competition itself was written up in http://www.computable.nl[Computable], a significant Netherlands' publication in the IT space.  You can read the article (in its original Dutch) http://www.computable.nl/artikel/achtergrond/development/5612777/1277180/de-pijnloze-toekomst-van-applicatieontwikkeling.html[here], but (courtesy of google) you can also read it https://translate.google.com/#auto/en/RAD%20Race%202015%0ADe%20pijnloze%20toekomst%20van%20applicatieontwikkeling%0A29-09-2015%2011%3A58%20%7C%20Door%20Dr%C3%A9%20de%20Man%20%7C%20Lees%20meer%20artikelen%20over%3A%20Ruby%20(on%20Rails)%20%7C%20Er%20zijn%20nog%20geen%20reacties%20op%20dit%20artikel%20%7C%20Dit%20artikel%20heeft%20nog%20geen%20cijfer%20(te%20weinig%20beoordelingen)%20%7C%20Permalink%0ARAD%20Race%202015%0AMiren%20Lafourcade%20toont%20de%20winnende%20applicatie%20aan%20de%20andere%20deelnemers.%20%5BFoto%3A%20Dr%C3%A9%20de%20Man%5D%0A%0ADe%20RAD%20Race%20heeft%20een%20lange%20traditie%3A%20dit%20jaar%20is%20de%20zeventiende%20editie%20en%20de%20eerste%20vond%20plaats%20in%201997.%20In%20het%20begin%20domineerden%20de%20case%20tools%20maar%20al%20snel%20volgenden%204GL%E2%80%99s%2C%20later%20kwamen%20daar%20de%20nieuwere%20talen%20met%20frameworks%20bij%2C%20compacte%20talen%20als%20Ruby%20en%20programma%E2%80%99s%20die%20al%20dan%20niet%20op%20basis%20van%20modellen%20code%20genereerde%20of%20bestaande%20code%20configureerden.%20De%20winnaar%20van%20dit%20jaar%2C%20Nout%2C%20heeft%20dan%20ook%20als%20motto%3A%20programmeer%20niet%2C%20parametriseer%20(%E2%80%98ne%20programmez%20pas%2C%20parametrisez%E2%80%99).%0A%0ANout%20heeft%20natuurlijk%20het%20gelijk%20van%20de%20winnaar%20aan%20zijn%20kant.%20De%20geschiedenis%20van%20de%20RAD%20Race%20bevestigt%20het%20gelijk%20van%20Nout%20nog%20eens.%20De%20teams%20die%20het%20allerbeste%20scoorden%20in%20al%20die%20jaren%2C%20waren%20steeds%20teams%20die%20modelleerden%20en%20configureerden%20en%20niet%20programmeerden.%20De%20teams%20die%20programmeerden%20met%20een%20conventionele%20taal%20als%20C%2B%2B%2C%20Java%20of%20C%23%20zonder%20veel%20hulp%20van%20frameworks%20die%20het%20programmeerwerk%20tot%20het%20uiterste%20beperkten%2C%20presteerden%20slecht.%0A4GL%0ACompacte%20talen%20als%20Ruby%2C%20python%2C%20et%20cetera%20en%20in%20een%20heel%20ver%20verleden%20Cobol%2C%20hebben%20in%20het%20verleden%20bewezen%20te%20kunnen%20concurreren%20met%20andere%20oplossingen%20maar%20lieten%20het%20dit%20jaar%20om%20welke%20reden%20dan%20ook%20afweten.%20Aan%20de%20andere%20kant%20zagen%20we%20twee%20namen%20die%20nog%20bijna%20uit%20de%20begintijd%20van%20de%20RAD%20Race%20stamden%2C%20in%20it-termen%20een%20eeuwigheid%20geleden%3A%20Progress%20en%20Uniface.%20Het%20team%20van%20Progress%20gebruikte%20echter%20niet%20de%20moderne%20versie%20van%20de%204GL%2C%20maar%20Rollbase%2C%20een%20door%20Progress%20overgenomen%20drag%20en%20drop-oplossing%20die%20in%20de%20categorie%20van%20nieuwe%20tools%20hoort.%20Rollbase%20produceert%20overigens%20Java-%20en%20Javascriptcode%20en%20Java-script.%20Verder%20gebruikte%20het%20team%20onder%20andere%20Open%20Edge.%20Uniface%20daarentegen%20werkte%20met%20Uniface%209.7%2C%20de%20allernieuwste%20versie%20van%20de%20oorspronkelijke%204GL.%204GL%E2%80%99s%20zijn%20ook%20compact%20en%20veel%20standaardfunctionaliteit%20wordt%20geconfigureerd.%20In%20loop%20der%20jaren%20is%20er%20echter%20heel%20veel%20moderne%20functionaliteit%20bijgekomen%20met%20name%20in%20het%20Uniface-platform%20zodat%20de%20applicaties%20zich%20bijvoorbeeld%20heel%20erg%20thuis%20voelen%20in%20de%20cloud.%20De%20komende%20dagen%20komen%20we%20hier%20waarschijnlijk%20nog%20op%20terug.%0ADe%20wedstrijd%20van%20dit%20jaar%20betrof%20een%20applicatie%20om%20geld%20te%20werven%20voor%20goede%20doelen%20(deze%20zal%20later%20ook%20algemeen%20beschikbaar%20worden).%20In%20eerste%20instantie%20was%20dat%20via%20een%20zogenaamd%20eetfeest%20(een%20Belgisch%20fenomeen)%20maar%20op%20dag%20twee%20van%20de%20race%20kregen%20de%20teams%20nog%20de%20opdracht%20om%20meerdere%20events%20mogelijk%20te%20maken%20en%20er%20nog%20een%20geheel%20ander%20evenement%20aan%20toe%20te%20voegen.%20Voor%20de%20beste%20deelnemers%20was%20dat%20laatste%20geen%20probleem%2C%20de%20meesten%20kwamen%20er%20echter%20niet%20meer%20aan%20toe.%0AC%2B%2B%0ANout%20won%20in%20de%20eerste%20plaats%20doordat%20ze%20de%20toch%20pittige%20opgave%20niet%20alleen%20binnen%20de%20gestelde%20tijd%2C%20geheel%20conform%20specificaties%20en%20met%20op%20een%20piepklein%20detail%20na%20werkende%20functionaliteit%20opleverde%20met%20extra%20functionaliteit%20(zie%20het%20artikel%20van%20gisteren).%20Het%20team%20van%20Nout%2C%20Miren%20Lafourcade%20en%20J%C3%A9r%C3%B4me%20Olivares%2C%20maakte%20gebruik%20van%20een%20eigen%20in%20C%2B%2B%20geschreven%20kern%2C%20Nout%20Builder%2C%20waarmee%20ze%20bouwstenen%20configureren%20die%20onder%20meer%20in%20html%2C%20Javascript%20en%20in%20toenemende%20mate%20in%20html5-applicaties%20opleveren.%20Er%20wordt%20niet%20geprogrammeerd%2C%20maar%20uitsluitend%20geconfigureerd.%0AThinkwise%20werkte%20met%20een%20datamodel%20dat%20in%20een%20reeks%20van%20databases%20in%20principe%20willekeurige%20programmeertalen%20applicaties%20genereert.%20Er%20wordt%20geconfigureerd%20maar%20er%20kunnen%20code-snippets%20worden%20toegevoegd%20die%20bij%20iedere%20nieuwe%20%20applicatiegeneratie%20behouden%20blijven.%20Nu%20was%20dat%20C%23%2C%20maar%20in%20theorie%20zou%20dat%20ieder%20andere%20taal%20kunnen%20zijn.%20Dat%20maakt%20het%20tool%20bijzonder%20toekomstbestendig.%20Door%20de%20grote%20aandacht%20voor%20business%20rules%20is%20het%20tool%20ook%20in%20dat%20opzicht%20klaar%20voor%20de%20toekomst.%20Jasper%20Kloost%20en%20Anne%20Buit%20van%20Thinkwise%20toonden%20zich%20blij%20verrast%20door%20de%20goede%20score%20en%20trokken%20bovendien%20conclusies%20uit%20de%20Race%20op%20basis%20waarvan%20ze%20verwachten%20volgend%20jaar%20te%20kunnen%20winnen.%0ACapgemini%20en%20Progress%0ANummer%20drie%20was%20een%20team%20van%20Capgemini%2C%20Robbert%20van%20der%20Pas%20en%20Hans%20Harts%2C%20met%20onder%20andere%20Visual%20Studio%202015%2C%20Resharper%2C%20Xamarin%20Studio%2C%20Xforece%20en%20Salesforce.%20Ook%20hier%20werd%20gemodelleerd%20en%20het%20bijzondere%20was%20dat%20de%20applicatie%20vooral%20geschikt%20was%20voor%20mobile%2C%20al%20kan%20in%20principe%20iedere%20user%20interface%20gebruikt%20worden.%20Het%20team%20deed%20vorig%20jaar%20ook%20al%20mee%20maar%20scoorde%20toen%20veel%20minder%20hoog.%20Ervaring%20zowel%20in%20technisch%20als%20in%20tactisch%20opzicht%20loont%2C%20zo%20blijkt%20steeds%20weer.%0AOok%20Het%20team%20van%20Progress%20slaagde%20erin%20de%20applicaties%20met%20de%20wijzigingen%20van%20dag%20twee%20af%20te%20krijgen.%20Het%20werkte%20met%20het%20Progress%20Rollbase-platform.%20Met%20name%20de%20manier%20waarop%20leveranciers%20gevarieerd%20konden%20worden%20was%20goed%20uitgewerkt%2C%20de%20jury%20was%20gecharmeerd%20maar%20het%20team%20had%20ook%20een%20paar%20aannamen%20gemaakt%20tijdens%20de%20bouw%20die%20zich%20later%20wreekten.%20In%20een%20echt%20project%20hadden%20die%20in%20goed%20overleg%20met%20de%20project%20owner%20waarschijnlijk%20vermeden%20kunnen%20worden.%0ATimeline%20en%20Incode.org%0ABij%20Timeline%20werd%20gewerkt%20met%20een%20eigen%20tool%20dat%20in%20feite%20ontwikkeld%20is%20om%20zeer%20specifieke%20erp-oplossingen%20te%20schrijven%20voor%20om%20het%20even%20welke%20branche%2C%20TimeLine%20Neo%2FDeveloper%20en%20met%20de%20bijbehorende%20TimeLine%20Server.%20Verder%20werd%20onder%20andere%20met%20VS%20Studio%20gewerkt.%20De%20structuur%20zat%20goed%20in%20elkaar%20en%20de%20jury%20was%20gecharmeerd%20van%20de%20duidelijke%20en%20fraaie%20schermlayout.%20Het%20team%20had%20een%20redelijke%20hoeveelheid%20functionaliteit%20af%20die%20er%20verder%20qua%20structuur%20en%20user%20interface%20zeer%20goed%20in%20elkaar%20zat.%0AJeroen%20van%20der%20Wal%20en%20Dan%20Haywood%20van%20Incode.org%20wisten%20met%20hun%20eigen%20opensource-oplossing%20%20ook%20goed%20te%20scoren.%20Zij%20werkten%20met%20Intellij%20IDEA%20en%20Apache%20isis%2C%20een%20open%20source%20ontwikkelframework%20voor%20Java%20dat%20werkt%20volgens%20de%20principes%20van%20Domain%20Driven%20Design%20en%20Naked%20Objects.%20De%20kracht%20van%20het%20framework%20is%20dat%20je%20alleen%20voor%20de%20domeinlaag%20code%20schrijft%20en%20dat%20de%20user%20interface%2C%20database%20en%20restful%20api%20in%20run-time%20gegenereerd%20worden.%20Het%20team%20zou%20een%20stuk%20beter%20gescoord%20hebben%2C%20ware%20het%20niet%20dat%20het%20heel%20veel%20tijd%20verloor%20met%20de%20data-import%2C%20overigens%20een%20vrijwel%20iedere%20jaar%20terugkerend%20probleem%20bij%20%C3%A9%C3%A9n%20van%20de%20teams.%0ADe%20basis%20van%20de%20door%20het%20team%20van%20Uniface%20gebouwde%20applicatie%20was%20heel%20goed.%20Een%20van%20de%20juryleden%20was%20er%20zelfs%20heel%20erg%20door%20bekoord.%20Toch%20had%20het%20team%20om%20welke%20reden%20dan%20ook%20minder%20geproduceerd%20dan%20de%20hoger%20ge%C3%ABindigde%20deelnemers%20en%20ontbraken%20essenti%C3%ABle%20zaken%20als%20de%20prijzen%20in%20de%20rapportage.%0AMendix%0ADat%20gold%20in%20nog%20sterkere%20mate%20voor%20het%20Capgemini-team%2C%20dat%20werkte%20met%20Mendix.%20Op%20de%20achtergrond%20waren%20heel%20veel%20zaken%20bijna%20klaar%20maar%20het%20team%20kon%20weinig%20functionaliteit%20tonen.%20Jammer%2C%20want%20Mendix%20is%20nu%20juist%20erg%20geschikt%20voor%20situaties%20als%20deze.%20Het%20team%20was%20zich%20echter%20ook%20erg%20bewust%20van%20de%20eigen%20tekortkomingen%3A%20er%20was%20te%20weinig%20(goed)%20overlegd%20en%20geanalyseerd.%20Het%20deed%20in%20dat%20opzicht%20denken%20aan%20het%20team%20van%20Capgemini%20van%20vorig%20jaar%2C%20dat%20het%20dit%20jaar%20zoveel%20beter%20deed.%0AAlle%20teams%20gaven%20aan%20dat%20ze%20enorm%20veel%20geleerd%20hadden.%20Zo%20gaf%20Nout%20aan%20dat%20het%20plannen%20maakte%20om%20sommige%20goede%20eigenschappen%20van%20het%20tool%20van%20nummer%20twee%2C%20Thinkwise%2C%20in%20hun%20product%20te%20integreren%2C%20net%20zoals%20Thinkwise%20overwoog%20sommige%20eigenschappen%20van%20Nout%20ter%20inspiratie%20te%20gebruiken.%20Zo%20doet%20de%20RAD%20Race%20precies%20dat%20wat%20er%20van%20verwacht%20zou%20mogen%20worden%3A%20het%20stoot%20bijna%20als%20een%20Formule%201-race%20de%20it-bedrijven%20op%20om%20hun%20tools%20zo%20ver%20mogelijk%20te%20perfectioneren.%20Voor%20de%20jury%20is%20dat%20alleen%20maar%20winst%3A%20zij%20zien%20vanaf%20een%20comfortabele%20afstand%20hoe%20de%20pijnloze%20toekomst%20van%20applicatieontwikkeling%20langzaam%20werkelijkheid%20wordt.%0A%0A%0ARead%20more%3A%20http%3A%2F%2Fwww.computable.nl%2Fartikel%2Fachtergrond%2Fdevelopment%2F5612777%2F1277180%2Fde-pijnloze-toekomst-van-applicatieontwikkeling.html%23ixzz3nQYy3KAZ[
translated to English].

And here's the paragraph that relates to our effort:

[quote, computable.nl, RAD Race 2015]
____
Jeroen van der Wal and Dan Haywood of http://incode.org[incode.org] with their own open-source solution also scored well. They worked with IntelliJ IDEA and Apache Isis, an open source development framework for Java that works on the principles of Domain Driven Design and Naked Objects. The strength of the framework is that you can only write for the domain layer code and the user interface, database and restful api be generated at run-time. The team would have scored a lot better, were it not that it lost a lot of time with the data import, incidentally, virtually every year recurring problem with one of the teams.
____



== The application

The requirements for the app were to create an application some sort of "club", eg soccer club or basketball club, or, I suppose, a scouts club or a school fundraisers club.  The idea was to build an app to allow this club to plan events, specifically focusing on putting together a menu.

The requirements ran to 16 pages, but I can't show them to you because they were under strict lock-n-key: the intellectual property belongs to the RAD RACE organizers.  But I can, I think, tell you what I remember:

* allow the club administrator to be able to define an event, with a menu, of various menu items (we had some example menus to get the idea). +
+
Members of the club could potentially get a different price from non-members


* allow non-administrators (whether members of the club or non-members) to self-register and to sign in. +
+
The idea was that there would be a link from the club's website to the sign-in page.

* allow registered users to place orders for attending an event, making their food selection from the event's menu (eg 3 x meat, 1 x fish, 2 x salads etc).

* the app should allow the registered user to print out the available menu (eg to show to their family and friends so that they could decide what they want), and also to print out an order once made

* the app would also allow the administrator to print out the order once placed, with an appropriate purchase order reference, and would also allow the administrator to print out a "pick list" for the items to purchase from each of the suppliers.

* the app should also allow the administrator to indicate when an order has been paid.  Out of scope was any integration with back-end payment systems.

In addition, we were provided with a spreadsheet of 5,000 users, each with a user/password.  The requirement was to upload that data such that the user could log into the system.  You'll find that spreadsheet https://github.com/incodehq/radrace2015/tree/master/data[here] (we checked it was okay to commit to our repo).


There were some further requirements that I'm a bit more vague about:

* be able to perform "marketing actions" so that the administrator could figure out how well their campaign for a particular event

* to support different event types

* some other stuff, I'm sure

Overall I think we implemented about 50~70% of the requirements, though some of that functionality was rather rough around the edges.  For the record, the winning team and runner up both implemented all the requirements, including some that were provided to the teams 45 minutes before the end of the competition.  Kudos to those guys; it was a challenging event.




== Domain model

The domain model that we ended up with was:

image::http://yuml.me/5166b3f3[link="http://yuml.me/edit/5166b3f3"]


Actually, our first version (sketched out in 10 minutes) was a little bit simpler than this... we simply had each menu item as many-to-one with ingredient.  But we spent a further 10 minutes later on in the first day refactoring to the more generalized design.

If you're a fan of Peter Coad's https://en.wikipedia.org/wiki/Object_Modeling_in_Color[Modeling in Color], then the "blue" stuff is ingredient, ingredient category, supplier; the green stuff is event, menu, menu item; the "pink" stuff is order, order item.

[source]
----
[Event]++->1[Menu]
[Menu]++->0..*[MenuItem]
[Person]<->*[Order]
[Order]++->0..*[OrderItem|quantity]
[OrderItem]->[MenuItem]
[MenuItem]->dependsUpon*>[MenuItem]
[MenuItem]*->*[Ingredient]
[Ingredient]*->[[IngredientCategory]
[Ingredient]*->[[Supplier]
----




== Learnings

When we came into the competition we had high hopes we might do well (after all, why bother otherwise?), but we also knew that there were a lot of unknowns that could affect how well we might do.

So, why didn't we win?

=== App requirements (actually, not a problem)

For myself, I had thought the biggest issue might be on the nature of the application that we were asked to build.  Apache Isis is ideally suited to "back office" systems, with rich behaviour and domains, and for use by domain experts who need a system to empower them.  On the other hand, it is less well suited to applications where an end-user needs to be guided through the app.  We characterize this as "problem solvers" vs "process followers".  Out-of-the-box Apache Isis favours the former, not the latter.

The app we were asked to build in the competition had aspects of both of these.  The club administrator part fits reasonably well into the domain expert/problem solver role, setting up ``Event``s, ``Menu``s and their ``MenuItem``s, the ``Ingredient``s and their ``Supplier``s.  On the other hand the registered user part doesn't really fit in well at all.  Notwithstanding the fact that we failed to provide a restrict the UI to just the elements that made sense to a registered user (shopping basket etc), in practice we would not normally expect a non-expert end user to use an Apache Isis app.  As mentioned above, instead we would have implemented some sort of custom UI against the REST API, using https://angular.io/[Angular] or similar.

In retrospect it was a mistake to bother creating the `ShoppingBasket` as a wrapper around the `Order`; one of those "seemed a good idea at the time" sort of things that probably muddled rather than illuminated our demo.  But a `ShoppingBasket` might well have been useful for a REST API.


=== Development Approach

There were some other reasons we didn't do as well as we thought we should.  One was just being a bit green about the gills; the team that won also won the year before, so they knew what to expect.  All said it was a pretty intense experience, quite exhausting.

More significantly we didn't take the time to look at the app properly from an end-users' viewpoint.  Without clearly-identified user stories to guide the development it was all somewhat slap-dash, rushing to add as many features as possible.  But we should have gone a bit slower and thought about the app from an end-users viewpoint.  That also showed in our demo at the end, which we didn't even rehearse.  We are both experienced enough developers to know better than this, so we let ourselves down there.


=== The framework and supporting tools

We also came away with some ideas to improve the framework, and its tooling.  As a result of the competition we ended up with a nice little mini-framework for loading up fixtures from spreadsheets, but it would be nice to have had that in our back pocket to start with.  Also, it would be easy enough to add a few wizards and templates to IntelliJ to generate some of the boilerplate.  Or, we could perhaps build a command line tool similar to https://grails.github.io/grails-doc/latest/guide/commandLine.html[Grails] or http://docs.spring.io/spring-roo/reference/html/beginning.html[Spring Roo].


=== Evaluation criteria

But the biggest issue turned out to be not the app we were asked to build (which was a reasonably good fit for Apache Isis); instead it was the evaluation criteria by which the entries were judged.

==== Testability

If you look through the codebase in this repo you'll see that there's a horrible lack of any sort of test, and that's because testability was not mentioned at all in the requirements for the app.  Instead, the emphasis was solely on implementing the features and then demonstrating them to "end-users".  We felt bad about writing code without tests, but since we weren't going to earn any credits by having such tests, we made the judgement call to code without.  That, of course, explains some of the bugs that we ended up with in the final app.

Still, we did use fixtures to seed our database, and ran the entire app (both development and our final demo) using an in-memory database.  Fixtures are very important when developing an Apache Isis application, because they allow us to ensure that the app is in a well-defined known state as we implement each new feature (the "given" of a "given/when/then" test).

We did lose quite a lot of time figuring out the best way to set up our data (though we're happy that we ended up with quite an elegant approach, one that we'll be feeding back into the framework).  Overall it was after 2pm on the first day (that is: about 1/3 of the overall time used) before we had our import scripts written. Compare that to other teams, which (when we spoke to them afterwards told us they) simply performed a one-off upload using SQL Server Integration Services or similar.  This didn't even occur to us as an approach.

==== Deployability

We want to be able to run our application as a demo in "development", to use the same fixture data within our http://isis.apache.org/guides/ug.html#_ug_testing_integ-test-support[integration tests] (running the app within a JUnit test framework), and of course be able to deploy the app into systest, UAT or production as a WAR file onto Tomcat etc.  We may be doing an injustice here, but it seemed that the other teams spent their time just configuring a single instance of an app for a one-off demo.  It doesn't really feel like building an app to us.  Could any of the other teams have put their app into a continuous integration environment such as http://travis-ci.org[Travis]?

Having not worked with any of the other CASE tools, we took the opportunity to ask some of the other teams how they tackled testability.  We can't speak for all of them, but the Mendix team, for example, told us that they "have a tester" on the team.  Exploratory manual testing is essential, of course, but when we probed further it didn't seem that that tool had very much to assist with the development of automated tests.

==== Maintainability/Data Quality

Another thing we care a lot about in Apache Isis is maintainability.  The framework doesn't care if you use it to build monoliths or microservices, but if you build the former then it's important to ensure that the various modules are fully decoupled.  Apache Isis' http://isis.apache.org/guides/ug.html#_ug_more-advanced_decoupling[support for decoupling] (contributed actions, its event bus etc) would have meant it would have scored well here.

Also, we learnt that some of the other competitors that their CASE tools were surprisingly naive when it came to data quality: they did not allow referential integrity to be enforced within the database.  Rather, such business rules are enforced by the application itself.  For any application deployed into production over a period of years there's a good chance that an undiscovered bug could result in data corruption.  In contrast, Apache Isis leverages the RDBMS to enforce referential integrity, even for polymorphic relationships, courtesy of the http://github.com/isisaddons/isis-module-poly[Isis addons' poly](morphic support) module.



=== Model Representation/Artifacts

The computable.nl article in its introduction made the point: "The teams that scored the best in [previous] years, were always [those that] modeled and configured and not programmed."  This seems to be a false dichotomy... one can after all model in a programming language such as Java, indeed that is exactly what a framework such as Apache Isis is all about.  We had the opportunity after the competition to chat with the ThinkWise team, and - to be honest - we seemed to share a very similar philosophy in that the domain model should sit in the middle of the app; the UI is - for the most part - a visual projection of that business domain.

So the question isn't about modelling vs programming, it's about in what form do you want your model artifacts to be represented?  In the case of Apache Isis your model is represented in Java, with a number of straightforward http://isis.apache.org/cheat-sheet.html[programming model conventions].  (Not that it would necessarily gain you much, but) it would be feasible to take an Apache Isis application and use its domain model almost unchanged within a Spring app, for example.

In the case of ThinkWise, that same model (as I understand it) is represented almost entirely as rows within tables of their database.  Certain business logic can be written in Java or C# and put behind a SOAP service, but the bulk of the model is ultimately in their own proprietary representation.  Following on from that, they have also implemented such concepts as branches and merging within the database.  Clever stuff, but it sounded to us rather like they'd reinvented a versioned filesystem within an RDBMS to hold their app's model artifacts.  For myself I'd much rather be using a standard open source tool such as https://git-scm.com/[git].

This next statement may be generalizing too far, be we suspect that it would be nigh on impossible to take any of the apps developed using one of the other teams and to reuse any of their code in the tool of some other team.  That is of course part of the business model for proprietary tools: they can undoubtedly provide great productivity, but in exchange your must accept vendor lock-in.

Given these other companies and tools have all proven themselves very successful, there's clearly a large number of customer organizations that are happy with this trade-off.  But we think we've demonstrated that an open source framework can provide at least similar productivity, but without any sort of vendor lock-in.




== Closing thoughts

It was a great experience to take part in the competition.  I wouldn't exactly call it fun, but I think we came out of it head held high.

We also learnt a lot about our value proposition.  If in the future we can see ourselves coming up against one of these other tools, we know a bit more about them to help the prospective customer decide:

* do you care that your application's domain model is stored using only the vendor's own proprietary representation?

* do you care about ongoing licensing costs?

* do you care about being able to recruit staff to maintain the apps that are built?

* do you care about being able to automate the tests?

* do you care that the tool may require using non-standard tools for other aspects of the development environment, such as version control or continuous integration?

If the customer doesn't care about any of that, then they should probably just go ahead and go with the proprietary tool.  But otherwise, they'd be better off choosing an open source tool; we think that Apache Isis has shown itself to be a worthy competitor.





== Appendix: Screenshots

As mentioned above, the competition ran for 8 hours over the first day and 4 hours on the second.  The afternoon was spent by the judges looking at all eight teams' efforts to decide on the overall winner.  The screenshots below show what we demonstrated... though in the heat of the battle I've realized that we forgot to show quite couple of things.

Anyway...


=== User sign-up

On the login page we configured the http://isis.apache.org/guides/rg.html#_rg_services-spi_manpage-UserRegistrationService[UserRegistrationService] SPI domain service along with the supporting http://isis.apache.org/guides/rg.html#_rg_services-api_manpage-EmailService[EmailService] API domain service in order that Apache Isis displayed the sign-up link:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/010-logon-page-sign-up-now.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/010-logon-page-sign-up-now.png"]

Although this was a requirement in the initial specs, later on in the competition this was descoped.  We didn't try it out because other competitors had said there were issues getting through the wifi firewall to SMTP servers.  But it should "just work" (we originally developed it for the Apache Isis-powered website for http://www.tellmegen.com/[TellMeGen]).



=== Logging in as club administrator

However, we also set up `domainapp-admin` as an our "club administrator".  This was part of our fixture data; when we develop Isis applications, we always run with an in-memory database (more on this later); our fixture data gets the app to a known initial state.

So, we can log in as the `domainapp-admin`:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/020-logon-page-as-admin.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/020-logon-page-as-admin.png"]



pass:[<br/>]

We customized the home page (using the http://isis.apache.org/guides/rg.html#_rg_annotations_manpage-HomePage[@HomePage] annotation) to return a http://isis.apache.org/guides/rg.html#_rg_annotations_manpage-ViewModel[view model] which showed the events for the club, past, present and future:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/030-home-page-admin.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/030-home-page-admin.png"]

We set up the fixture data so that the "BBQ Event" would be current.  As I write these words, that was a week ago... and so it is now in the "past events" bucket.



=== BBQ Event

Each `Event` consists of a bunch data, including the (strangely named) inscription start and end dates; I think the idea was those represent the dates that someone can choose to attend the event.

As per our domain model (above), we decided that each `Event` would have precisely one `Menu`.  We probably made things a bit more difficult than they needed to be, but the competition organizer made hints that we should keep the application flexible for future requirements changes.  This went against our better instincts (YAGNI), but on balance we felt that since `Event` and `Menu` were part of the http://martinfowler.com/bliki/UbiquitousLanguage.html["ubiquitous language"], it probably made sense to have them both in the app:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/040-event.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/040-event.png"]




pass:[<br/>]

Here's what our `Menu` domain object looks like:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/050-menu.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/050-menu.png"]

It consists of a list of ``MenuItem``s, each of which has a price for the member.  We decided that the non-member price would be defined a the `Menu` level ("non member-supplement").


From the `Menu` new items can be created:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/060-menu-item-create.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/060-menu-item-create.png"]

Normally we would have positioned the `newItem(...)` action button with the `items` collection; this can be done with the https://github.com/incodehq/radrace2015/blob/master/dom/src/main/java/domainapp/dom/menu/Menu.layout.json[.layout.json] file.  We forgot.



=== Publishing a Menu

Once a `Menu` has been defined, one of the requirements was to be able to "publish" it, eg so that it could be downloaded from a website for would-be attendees to peruse:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/070-publish-menu.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/070-publish-menu.png"]



pass:[<br/>]

Our application used the http://github.com/isisaddons/isis-module-docx[Isis addons' docx] module to generate a Word document based on a Word template (using Smart tags).

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/080-menu-downloaded.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/080-menu-downloaded.png"]



pass:[<br/>]

Viewing in Word gives the following glorious experience:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/090-menu-in-word.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/090-menu-in-word.png"]

We admit it, not pretty.  However, the point of the http://github.com/isisaddons/isis-module-docx[Isis addons' docx] module is that the template (into which the data is "mail merged") is designed using nothing more esoteric than Word itself.   You can find the template https://github.com/incodehq/radrace2015/blob/master/app/src/main/java/domainapp/app/services/export/MenuReport.docx[here].



=== Excel downloads

As a bit of "candyfloss" we decided to integrate the http://github.com/isisaddons/isis-module-excel[Isis addons' excel] module, which allows any table to be downloaded as an Excel spreadsheet.

For example, the menu items collection:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/100-menu-items-alternative-views.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/100-menu-items-alternative-views.png"]



pass:[<br/>]

can be viewed as a "download as Excel" view:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/110-menu-items-download-as-excel.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/110-menu-items-download-as-excel.png"]



pass:[<br/>]

meaning that it can be downloaded as a `.xlsx` file and then opened within Excel:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/120-menu-items-in-excel.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/120-menu-items-in-excel.png"]



=== Ingredients and Suppliers

The club administrator can also use the app to set up ``Ingredient``s with associated `Supplier` and `IngredientCategory`.  We loaded this fixture data from an https://github.com/incodehq/radrace2015/blob/master/fixture/src/main/java/domainapp/fixture/scenarios/spreadsheets/EventImport.xls[spreadsheet]; each row corresponded to a https://github.com/incodehq/radrace2015/blob/master/fixture/src/main/java/domainapp/fixture/scenarios/spreadsheets/EventImport.java[view model] which used injected services to actually https://github.com/incodehq/radrace2015/blob/master/fixture/src/main/java/domainapp/fixture/scenarios/spreadsheets/EventImport.java#L212[create] the entities.

The "All Ingredients" menu item:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/200-ingredients.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/200-ingredients.png"]




pass:[<br/>]

returns a list of ``Ingredient``s that are imported from the fixture data spreadsheet:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/210-ingredients-list-all.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/210-ingredients-list-all.png"]



pass:[<br/>]

Our `Ingredient` object looked like:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/220-ingredient.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/220-ingredient.png"]

defining a recursive structure (``Ingredient``s can consist of other ``Ingredient``s), and also dependencies between ``Ingredient``s.


Both of these relationships can be maintained.  For example, we can set up a new dependency between ingredients:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/240-ingredient-depend-upon-prompt.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/240-ingredient-depend-upon-prompt.png"]



pass:[<br/>]

so that (in this case) the bearnaise sauce can only be ordered if steak has been ordered.

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/260-ingredient-depends-upon-collection.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/260-ingredient-depends-upon-collection.png"]

What we didn't do in the competition is to translate this dependency into a rule to be implemented when the end-user creates their actual `Order`.  But the data is at least there to do so.




pass:[<br/>]

Incidentally, Apache Isis automatically maintains a list of most recently visited objects, accessible top-left or using `ctrl+[`.  In the screenshot below you can see a number of objects that I visited while capturing these screenshots:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/400-bookmarks.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/400-bookmarks.png"]



=== Event Orders

Returning to the `Event` object, we can see that the club administrator can also view any ``Order``s that have been placed:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/500-event-orders.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/500-event-orders.png"]

Next, let's look at how those ``Order``s are placed by registered users.



=== Registered Users' workflow

(As noted above), the competition organizers provided us with a https://github.com/incodehq/radrace2015/blob/master/data/people.xls[spreadsheet of 5,000 user records] to upload.

We loaded this data using our https://github.com/incodehq/radrace2015/blob/master/fixture/src/main/java/domainapp/fixture/scenarios/spreadsheets/PeopleImport.java[PeopleImport] fixture data, which sets up not only the `Person` entity but also a corresponding `ApplicationUser` as per our integration with the http://github.com/isisaddons/isis-module-security[Isis addons' security] module.

Thus, we can login with any of the users; for example the first one in the spreadsheet, "theo.aelbers".

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/510-logon-page-as-theo.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/510-logon-page-as-theo.png"]




pass:[<br/>]

The http://github.com/isisaddons/isis-module-security[Isis addons' security] module allows different users to have different role, and our intention was to set up the regular user with different permissions to the club administrator so that they would only see the "stuff" relevant to them.  Unfortunately we ran out of time, meaning that they got to see the same home page and top-level menu:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/520-home-page-theo.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/520-home-page-theo.png"]



pass:[<br/>]

The two top-level menu items that *would* be relevant to a regular user would have been the "Events" menu, to view any up-coming events:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/530-available-events.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/530-available-events.png"]



pass:[<br/>]

and also the "Orders" menu, to view any orders that they had placed:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/540-orders-for-events.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/540-orders-for-events.png"]



pass:[<br/>]

As the screenshot below shows, we also didn't filter the list of returned ``Order``s, meaning that (unfortunately) our regular user was also able to see the orders placed by other users:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/550-inspect-order.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/550-inspect-order.png"]

If we had had time, we would probably have used the multi-tenancy feature that is provided by the http://github.com/isisaddons/isis-module-security[Isis addons' security] module.  Each person/user would have a corresponding `ApplicationTenancy`, and we each `Order` would implement the `WithApplicationTenancy` interface by which it would indicate which user could have access to it.  The security module's concept of multi-tenancy is hierarchical, so we would have set the club administrator as global app tenancy, in other words able to view all ``Order``s.


Moving on... looking to demonstrate that Apache Isis can provide a different user experience for different user/roles, we decided to implement a `ShoppingBasket` for each `Order`.

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/560-open-basket.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/560-open-basket.png"]



pass:[<br/>]

The `ShoppingBasket` is a view model on top of the `Order`, the idea being that it guides the end-user through the steps of completing an `Order`.  For example, it allows the user to select available ``MenuItem``s from the ``Event``'s `Menu` and to create corresponding ``OrderItem``s for each:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/570-add-order-items.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/570-add-order-items.png"]

Only ``MenuItem``s which have not previously been selected (ie for which there are not ``OrderItem``s in the basket) are shown.


The UI, it has to be said, is somewhat odd here.  As of this writing Apache Isis does not support the concept of collections as parameters to actions, meaning that it isn't possible to select multiple items and add them to the basket in a single go.  The best can currently do is to use a http://isis.apache.org/guides/rg.html#_rg_annotations_manpage-Action_invokeOn["bulk" action] against a collection of objects, the checkboxes in the UI allowing the end-user to select multiple items:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/580-select-menu-items-to-create-order-item.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/580-select-menu-items-to-create-order-item.png"]

We've had a https://issues.apache.org/jira/browse/ISIS-785[JIRA ticket] for this feature a good while now; something to tackle soon.

Still, what we implemented of the competition worked in a roundabout way; if the user selects a `MenuItem` then an `OrderItem` is created.

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/590-order-updated.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/590-order-updated.png"]



pass:[<br/>]

The `ShoppingBasket` also allows the quantity of each to be updated.  Here though there was a bug... rather than listing the menu items that were in the basket, the dialog showed the menu items *not* in the basket (!).  Silly:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/600-update-quantity.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/600-update-quantity.png"]




pass:[<br/>]

Not suprisingly, this meant that we didn't actually have a way for the end user to change the quantities of each order item:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/620-order-item-should-have-been-updated.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/620-order-item-should-have-been-updated.png"]



=== Print Order

Another requirement was for the end-user to be able to print out their order:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/630-print-order.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/630-print-order.png"]



pass:[<br/>]

Once more we used the http://github.com/isisaddons/isis-module-docx[Isis addons' docx] module, this time with a slightly prettier https://github.com/incodehq/radrace2015/blob/master/app/src/main/java/domainapp/app/services/export/OrderReport.docx[Word template]:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/650-view-order-in-word.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/650-view-order-in-word.png"]




=== Submit basket

Once the user had finished constructing their order, they could use the ``ShoppingBasket``'s `submit(...)` action to complete:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/660-basket-submit-order.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/660-basket-submit-order.png"]



pass:[<br/>]

Voila, the basket's status changed.  We only implemented a very simple https://github.com/incodehq/radrace2015/blob/master/dom/src/main/java/domainapp/dom/order/OrderStatus.java[state chart] for ``Order``s; once the order was submitted there was no going back:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/670-order-submitted-and-immutable.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/670-order-submitted-and-immutable.png"]




=== Payment processing

Back as the club administrator:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/700-logon-as-admin.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/700-logon-as-admin.png"]



pass:[<br/>]

We can use the ``Order``'s `paymentReceived(...)` action to indicate that money has been received from the user:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/710-order-payment-received.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/710-order-payment-received.png"]



pass:[<br/>]

As a bit of candyfloss, we decided to support partial payments:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/720-partial-payment.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/720-partial-payment.png"]



pass:[<br/>]

which worked up to a point; here you can see that the amount outstanding has been reduced:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/730-payment-received-updated.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/730-payment-received-updated.png"]



pass:[<br/>]

Invoking the action again we see that the parameter is defaulted to the remaining amount to be paid:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/740-further-payment-defaulted.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/740-further-payment-defaulted.png"]



pass:[<br/>]

However there were some bugs, which just goes to show that it's always better to get the app working first for the simple use case, then enhance later if time and is required.  For example it turned out that when entering the payment the amount was rounded down, so any cents could not be entered.  Another silly mistake:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/770-bug-rounds-down.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/770-bug-rounds-down.png"]



=== Payment Reference

Another of the requirements was to allow the club administrator to print out the order, with a payment reference constructed according to some deliberately bizarre rules.  Well, we did the hard work, which was to implement the functionality for generating the payment reference in a nice little https://github.com/incodehq/radrace2015/blob/master/dom/src/main/java/domainapp/dom/payments/PaymentReferenceService.java[PaymentReferenceService] (complete with a tiny little https://github.com/incodehq/radrace2015/blob/master/dom/src/test/java/domainapp/dom/payments/PaymentReferenceServiceTest.java[unit test]).  But we never got around to generating the order invoice that used this payment reference.



=== Suppliers

A further requirement was for the club administrator to be able to generate a "pick list" for each supplier of ingredients for an event.  The club administrator could view the ``Supplier``s:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/810-view-suppliers.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/810-view-suppliers.png"]



pass:[<br/>]

which returned the list of suppliers set up by our fixture data:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/820-supplier-list-all.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/820-supplier-list-all.png"]



pass:[<br/>]

Inspecting one of those ``Supplier``s we provided an `ingredientsToOrder(...)` action:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/830-ingredients-to-order.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/830-ingredients-to-order.png"]



pass:[<br/>]

The club administrator specifies the `Event`:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/840-ingredients-to-order-specify-event.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/840-ingredients-to-order-specify-event.png"]



pass:[<br/>]

and this generates the pick list, once more as a Word document:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/860-ingredients-to-order-open-in-word.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/860-ingredients-to-order-open-in-word.png"]



=== Security Module

As mentioned earlier, we integrated the http://github.com/isisaddons/isis-module-security[Isis addons' security] module in order to provide user logins, and roles/permissions, and could have also used for multi-tenancy support.

We didn't demonstrate any of this in the competition, but the screenshot below shows that there's a complete security subsystem available for the administrator to use.  For example we can view all the users (the security module's `ApplicationUser` entity):

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/900-all-users.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/900-all-users.png"]



pass:[<br/>]

As the screenshot below shows, our fixture set up a corresponding `ApplicationUser` for each `Person` in the provided spreadsheet:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/910-person-is-an-application-user.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/910-person-is-an-application-user.png"]



pass:[<br/>]

For each `ApplicationUser`, we have corresponding ``ApplicationRole``s.  Each registered user just had a regular (`domainapp-regular-user`) role:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/920-person-has-roles.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/920-person-has-roles.png"]




pass:[<br/>]

while the club administrator had a bunch more roles, including, for example, the ability to administrate security itself:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/930-admin-has-security-admin-role.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/930-admin-has-security-admin-role.png"]

We didn't code any of this in the competition; this is just the "out-of-the-box" UI of the security module.

As was discussed earlier, the security module also supports multi-tenancy.  Thus, our club administrator had the ability to switch tenancy:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/940-tenancy-switcher.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/940-tenancy-switcher.png"]



pass:[<br/>]

so that they could view all orders for all users if required.

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/950-switch-tenancy.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/950-switch-tenancy.png"]



=== Person

For each `ApplicationUser` there is also a `Person` instance.  We provided the ability for the club administrator to search for ``Person``s:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/960-person-find-by-name.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/960-person-find-by-name.png"]



pass:[<br/>]

For example, the sample data had a bunch of people with the surname "Aelber":

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/970-person-find-by-name-prompt.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/970-person-find-by-name-prompt.png"]



pass:[<br/>]

Supporting this using https://github.com/incodehq/radrace2015/blob/master/dom/src/main/java/domainapp/dom/person/Person.java#L68[JDOQL] was easily done:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/980-person-list.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/980-person-list.png"]



pass:[<br/>]

For a given `Person` one could then view their ``Order``s:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/990-person.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/990-person.png"]

We chose to implement this as a https://github.com/incodehq/radrace2015/blob/master/dom/src/main/java/domainapp/dom/order/OrderContributionsOnPerson.java#L50[contributed collection], thereby decoupling `Person` from `Order`.  What we also could have done, but didn't think to, was to provide the ability to switch back and forth between `Person` and `ApplicationUser`.  That could have been done if `Person` had implemented Isis' built-in `HasUsername` interface; contributed actions provided by the security module would've done the rest.



=== REST API

Although we didn't demonstrate this in the competition (there were no requirements for such), the app that we built does of course have its own REST API, because Apache Isis will automatically surface the domain model as REST resources.  If this were a "real" app, then we would have looked to use the REST API to provide a custom UI for the registered user, perhaps using https://angular.io/[Angular] or similar.

To access the REST API, one must login:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/994-rest-api.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/994-rest-api.png"]



pass:[<br/>]

From the home page we can go to the list of services, such as the `EventMenu` service:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/995-rest-services.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/995-rest-services.png"]



pass:[<br/>]

This in turn lists the available actions, one of which is the `allEvents(...)` action:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/996-rest-events-list.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/996-rest-events-list.png"]



pass:[<br/>]

This https://github.com/incodehq/radrace2015/blob/master/dom/src/main/java/domainapp/dom/event/EventMenu.java#L48[action has safe (query-only)] semantics, so can be invoked with an HTTP GET:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/997-rest-events-list-invoke.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/997-rest-events-list-invoke.png"]



pass:[<br/>]

which returns links to a list of ``Event``s:

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/997-rest-event-view.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/997-rest-event-view.png"]




pass:[<br/>]

Following one of those links results in the representation of an `Event`.

image::https://raw.githubusercontent.com/incodehq/radrace2015/master/images/999-rest-event.png[link="https://raw.githubusercontent.com/incodehq/radrace2015/master/images/999-rest-event.png"]

If we were to open up the REST API for third parties, then we would restrict these domain entities by security, and instead only surface view models (such as `ShoppingBasket`) that would wrap the underlying domain entities and provide a level of abstraction (so that the underlying entities can evolve independently as needs be).





